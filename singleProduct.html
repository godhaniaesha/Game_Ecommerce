<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Product</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/x_style.css">
    <link rel="stylesheet" href="./css/d_style.css">
    <link rel="stylesheet" href="/css/checkout.css" />
    <link rel="stylesheet" href="./css/card.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />

</head>

<body>
    <div class="d_main">
        <!-- Header -->
        <header class="d_header d-flex align-items-center justify-content-between">
            <div class="d_logo">
                <i class="fas fa-dragon"></i> GameForge
            </div>

            <!-- Desktop Nav -->
            <nav class="d_navbar navbar navbar-expand-lg d-none d-lg-flex">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="landingpage.html">Home</a></li>
                    <li class="nav-item "><a class="nav-link active" href="allProduct.html">Games</a></li>
                    <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="About_us.html">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="./Contact_us.html">Contact</a></li>
                </ul>

                <form class="d_search_form ">
                    <input type="search" placeholder="Search games..." />
                    <button type="submit"><i class="fas fa-search"></i></button>
                </form>

                <div class="d_social_icons me-3">
                    <a href="./Cart.html"><i class="fa fa-cart-plus"></i></a>
                </div>

                <div class="d_user_icon_wrapper position-relative">
                    <div class="d_user_icon" id="db_user_icon" title="User Profile">
                        <i class="fas fa-user-circle"></i>
                    </div>

                    <div class="d_user_dropdown" id="db_user_dropdown">
                        <ul>
                            <li><a href="./auth/Login.html">Sign in</a></li>
                            <li><a href="./auth/ForgetPass.html">Change Password</a></li>
                            <li><a href="Profile.html">My Profile</a></li>
                            <li><a href="#">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </nav>

            <!-- Mobile Toggler -->
            <button class="d_toggler_btn d-lg-none" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
        </header>

        <!-- Offcanvas Mobile Menu -->
        <aside class="d_offcanvas_menu" id="d_offcanvas_menu">
            <button class="close_btn" aria-label="Close Menu">&times;</button>
            <nav>
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link active" href="landingpage.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="allProduct.html">Games</a></li>
                    <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="About_us.html">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="./Contact_us.html">Contact</a></li>
                </ul>
            </nav>
            <form class="d_search_form_offcanvas">
                <input type="search" placeholder="Search games..." />
                <button type="submit"><i class="fas fa-search"></i></button>
            </form>
            <div class="d_social_icons_offcanvas">
                <a href="./Cart.html"><i class="fa fa-cart-plus"></i></a>
                <a href="Profile.html"><i class="fas fa-user-circle"></i></a>
            </div>
        </aside>
    </div>

    <!-- x_game-product-section START -->
    <section class="x_game-shop a_header_container">
        <div class=" x_game-product-section py-5">
            <div class="x_space">

                <div class="row">
                    <!-- Thumbnails -->
                    <div class="col-md-1 d-none d-md-flex flex-column align-items-center x_thumb-list">
                        <img src="./images/gg1.png" class="img-fluid mb-3 x_thumb-img" alt="thumb1">
                        <img src="./images/gg1.png" class="img-fluid mb-3 x_thumb-img" alt="thumb2">
                        <img src="./images/gg2.png" class="img-fluid mb-3 x_thumb-img" alt="thumb3">
                        <img src="./images/gg3.png" class="img-fluid x_thumb-img" alt="thumb4">
                    </div>
                    <!-- Main Image -->
                    <div class="col-md-5 text-center x_main-img-wrap">
                        <img src="./images/gg1.png" class="img-fluid x_main-img" alt="main">
                    </div>
                    <!-- Product Info -->
                    <div class="col-md-6 x_product-info text-white">
                        <div class="x_shop_info mt-3 mt-sm-0">
                            <h2 class="x_product-title">Falldown Republic</h2>
                            <div class="x_product-price mb-3">£95.00</div>
                            <div class="d-flex align-items-center mb-3 ">

                                <button class="btn btn-outline-light x_add-cart-btn px-md-4 px-3 me-3">BUY NOW</button>

                                <button class="btn btn-outline-light x_add-cart-btn px-md-4 px-3">ADD TO CART</button>
                            </div>
                            <div class="x_product-meta x_line_tb mb-2">
                                <div>SKU: 004</div>
                                <div>Category: Games</div>
                                <div>Tags: ps4, xbox one</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Tabs -->
                <div class="row mt-md-5 mt-4">
                    <div class="col-12">
                        <ul class="nav nav-tabs x_tabs w-100 overflow-x-auto overflow-y-hidden flex-nowrap text-nowrap"
                            id="x_productTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active x_tab-link" id="desc-tab" data-bs-toggle="tab"
                                    data-bs-target="#desc" type="button" role="tab">Description</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link x_tab-link" id="addinfo-tab" data-bs-toggle="tab"
                                    data-bs-target="#addinfo" type="button" role="tab">Additional Information</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link x_tab-link" id="reviews-tab" data-bs-toggle="tab"
                                    data-bs-target="#reviews" type="button" role="tab">Reviews (0)</button>
                            </li>
                        </ul>
                        <div class="tab-content x_tab-content p-4 bg-opacity-75" id="x_productTabContent">
                            <div class="tab-pane fade show active" id="desc" role="tabpanel">
                                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo ligula eget
                                dolor.
                                Aenean massa. Cum sociis Theme natoque penatibus et magnis dis parturient montes,
                                nascetur
                                ridiculus mus. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus.
                                Phasellus
                                viverra nulla ut metus varius laoreet. Quisque rutrum.
                            </div>
                            <div class="tab-pane fade" id="addinfo" role="tabpanel">
                                <div class="x_additional-info">
                                    <h5 class="mb-3">Additional information</h5>
                                    <div class="row mb-2">
                                        <div class="col-4 col-md-2">Weight</div>
                                        <div class="col-8 col-md-10">0.100 kg</div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-4 col-md-2">Dimensions</div>
                                        <div class="col-8 col-md-10">30 × 15 × 3 cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="reviews" role="tabpanel">
                                <div class="x_reviews">
                                    <h5 class="mb-3">Reviews</h5>
                                    <p>There are no reviews yet.</p>
                                    <p>Be the first to review <b>"Falldown Republic"</b></p>
                                    <p class="mb-1">Your email address will not be published. Required fields are marked
                                        *</p>
                                    <form class="x_review-form">
                                        <div class="mb-2">Your rating *</div>
                                        <div class="mb-3 x_rating-stars">
                                            <i class="fa-regular fa-star"></i>
                                            <i class="fa-regular fa-star"></i>
                                            <i class="fa-regular fa-star"></i>
                                            <i class="fa-regular fa-star"></i>
                                            <i class="fa-regular fa-star"></i>
                                            <div class="invalid-feedback d-block x_rating-error" style="display:none;">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="review" class="form-label">Your review *</label>
                                            <textarea class="form-control bg-transparent text-white border-secondary"
                                                id="review" rows="4"></textarea>
                                            <div class="invalid-feedback d-block x_review-error" style="display:none;">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="name" class="form-label">Name *</label>
                                            <input type="text"
                                                class="form-control bg-transparent text-white border-secondary"
                                                id="name">
                                            <div class="invalid-feedback d-block x_name-error" style="display:none;">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="email" class="form-label">Email *</label>
                                            <input type="email"
                                                class="form-control bg-transparent text-white border-secondary"
                                                id="email">
                                            <div class="invalid-feedback d-block x_email-error" style="display:none;">
                                            </div>
                                        </div>
                                        <div class="form-check promo-code  checkbox-item mb-3 p-0  ">
                                            <!-- <input class="form-check-input" type="checkbox" id="saveInfo"> -->
                                            <div class="custom-checkbox"></div>
                                            <label class="form-check-label" for="saveInfo">
                                                Save my name, email, and website in this browser for the next time I
                                                comment.
                                            </label>
                                        </div>
                                        <div class="text-center">
                                            <button type="submit"
                                                class="x_btn btn btn-outline-light mx-auto">SUBMIT</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- slider -->
                <h3 class="mb-3 mt-5" style="font-weight:600; color: #8a775a;">More Like This</h3>
                <div class="swiper mySwiper py-4 mt-3">
                    <div class="swiper-wrapper" id="swiperCards">
                        <!-- Cards will be injected here by JS -->
                    </div>
                    <!-- Add navigation buttons
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    Add pagination
                    <div class="swiper-pagination"></div> -->
                </div>
            </div>
        </div>
    </section>
    <footer class="d_footer text-white">
        <div class="container py-md-3 ">
            <div class="row gy-4">
                <div class="col-md-3">
                    <h4 class="d_footer-logo mb-3">GAMEFORGE</h4>
                    <p class="d_footer_text">A realm where ancient horrors dwell and forgotten heroes rise again.
                        Unleash your
                        legend in the shadows.</p>
                </div>
                <div class="col-md-2 col-6">
                    <h5 class="text-white mb-3">Quick Links</h5>
                    <ul class="list-unstyled d_footer-links">
                        <li><a href="landingpage.html">Home</a></li>
                        <li><a href="games.html" class="active">Games</a></li>
                        <li><a href="About_us.html">About</a></li>
                        <li><a href="Contact_us.html">Contact</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-6">
                    <h5 class="text-white mb-3">Our Policy</h5>
                    <ul class="list-unstyled d_footer-links">
                        <li><a href="landingpage.html">Home</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="Privacy.html">Privacy</a></li>
                        <li><a href="services.html">Service</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5 class="text-white mb-3">Contact</h5>
                    <ul class="list-unstyled d_footer-links d_footer_text">
                        <li><i class="fas fa-envelope me-2"></i> support@gameforge.com</li>
                        <li><i class="fas fa-phone me-2"></i> +91 98765 43210</li>
                        <li><i class="fas fa-location-dot me-2"></i> GameForge HQ, Darkrealm</li>
                    </ul>
                    <div class="d_footer-social mt-3">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-x-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-discord"></i></a>
                    </div>
                </div>
            </div>
            <hr class="border-secondary mt-4" />
            <div class="text-center d_footer_text small">
                &copy; 2025 GAMEFORGE. All rights reserved.
            </div>
        </div>
    </footer>
    <!-- x_game-product-section END -->
    <!-- Bootstrap JS & jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Logout functionality
        document.querySelectorAll('a').forEach(function (link) {
            if (link.textContent.trim().toLowerCase() === 'logout') {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    localStorage.removeItem('user_id');
                    window.location.href = 'landingpage.html';
                });
            }
        });
    </script>
    <script>
        // Show first letter of user email in user icon if logged in
        document.addEventListener('DOMContentLoaded', async function () {
            const userId = localStorage.getItem('user_id');
            const userIconDiv = document.getElementById('db_user_icon');
            if (userId && userIconDiv) {
                try {
                    const res = await fetch(`http://localhost:4000/users/${userId}`);
                    if (res.ok) {
                        const user = await res.json();
                        if (user.email && user.email.length > 0) {
                            userIconDiv.innerHTML = `<span style="font-size:20px;font-weight:200;display:inline-block;width:2.2rem;height:2.2rem;line-height:2.2rem;text-align:center;background:#ad9d79;color:#fff;border-radius:50%;">${user.email[0].toUpperCase()}</span>`;
                        }
                    }
                } catch (e) {
                    // fallback: keep icon
                }
            }
        });
    </script>
    <script>
        (function () {
            const toggler = document.querySelector('.d_toggler_btn');
            const offcanvas = document.getElementById('d_offcanvas_menu');
            const closeBtn = offcanvas.querySelector('.close_btn');

            toggler.addEventListener('click', () => {
                offcanvas.classList.add('active');
                document.body.style.overflow = 'hidden';
            });

            closeBtn.addEventListener('click', () => {
                offcanvas.classList.remove('active');
                document.body.style.overflow = '';
            });

            document.addEventListener('click', (e) => {
                if (!offcanvas.contains(e.target) && !toggler.contains(e.target)) {
                    offcanvas.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    offcanvas.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });

            // Sticky header scroll effect
            window.addEventListener('scroll', () => {
                const header = document.querySelector('.d_header');
                if (window.scrollY > 20) {
                    header.classList.add('d_scrolled');
                } else {
                    header.classList.remove('d_scrolled');
                }
            });
        })();
    </script>
    <script>
        // Image thumbnail click to main image swap
        $(document).ready(function () {
            $('.x_thumb-img').on('click', function () {
                var newSrc = $(this).attr('src');
                $('.x_main-img').attr('src', newSrc);
                $('.x_thumb-img').removeClass('active');
                $(this).addClass('active');
            });
            // Set first thumb as active on load
            $('.x_thumb-img').first().addClass('active');

            // Star rating click
            $('.x_rating-stars i').on('click', function () {
                var index = $(this).index();
                $('.x_rating-stars i').each(function (i) {
                    if (i <= index) {
                        $(this).removeClass('fa-regular').addClass('fa-solid');
                    } else {
                        $(this).removeClass('fa-solid').addClass('fa-regular');
                    }
                });
                // Store rating value
                $('.x_review-form').data('rating', index + 1);
            });

            // Review form validation
            $('.x_review-form').on('submit', function (e) {
                var valid = true;
                var rating = $(this).data('rating') || 0;
                var review = $('#review').val().trim();
                var name = $('#name').val().trim();
                var email = $('#email').val().trim();
                var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                // Reset errors
                $('.x_rating-error, .x_review-error, .x_name-error, .x_email-error').hide().text("");
                $('#review, #name, #email').removeClass('is-invalid');
                $('.x_rating-stars').removeClass('is-invalid');
                // Validate fields
                if (rating === 0) {
                    $('.x_rating-error').text('Please select a rating.').show();
                    $('.x_rating-stars').addClass('is-invalid');
                    valid = false;
                }
                if (review.length < 5) {
                    $('.x_review-error').text('Please enter a review (min 5 characters).').show();
                    $('#review').addClass('is-invalid');
                    valid = false;
                }
                if (name.length < 2) {
                    $('.x_name-error').text('Please enter your name.').show();
                    $('#name').addClass('is-invalid');
                    valid = false;
                }
                if (!emailPattern.test(email)) {
                    $('.x_email-error').text('Please enter a valid email address.').show();
                    $('#email').addClass('is-invalid');
                    valid = false;
                }
                if (!valid) {
                    e.preventDefault();
                }
            });


        });
    </script>
    <script>
        const dbUserIcon = document.getElementById('db_user_icon');
        const dbUserDropdown = document.getElementById('db_user_dropdown');

        dbUserIcon.addEventListener('click', (e) => {
            e.stopPropagation();
            dbUserDropdown.style.display = dbUserDropdown.style.display === 'block' ? 'none' : 'block';
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
            dbUserDropdown.style.display = 'none';
        });
    </script>
    <script>
        // Example cards data (replace with your real data if needed)
        const cardsData = [
            { id: 1, title: "The Elder Scrolls V Skyrim", price: "$144.00", image: "/images/card_img1.png" },
            { id: 2, title: "Grand Theft Auto V", price: "$89.99", image: "/images/card_img2.png" },
            { id: 3, title: "Call of Duty: Modern Warfare", price: "$129.00", image: "/images/card_img3.png" },
            { id: 4, title: "FIFA 24", price: "$99.99", image: "/images/card_img4.png" },
            { id: 5, title: "Assassin's Creed Valhalla", price: "$79.99", image: "/images/card_img5.png" },
            { id: 6, title: "Cyberpunk 2077", price: "$159.99", image: "/images/card_img6.png" }
        ];

        function renderSwiperCards() {
            const swiperCards = document.getElementById('swiperCards');
            swiperCards.innerHTML = cardsData.map(card => `
                <div class="swiper-slide d-flex justify-content-center">
                    <div class="game-card position-relative">
                        <img src="${card.image}" alt="${card.title}" class="card-img-top" />
                        <div class="position-absolute card-content">
                            <div class="icons d-flex gap-2 mb-3">
                                <i class="fa-brands fa-apple"></i>
                                <i class="fa-brands fa-windows"></i>
                            </div>
                            <h3>${card.title}</h3>
                            <h3 class="mb-0">${card.price}</h3>
                        </div>
                        <div class="card-actions d-flex align-items-center gap-3 ">
                            <div class="d_main_button w-100">
                                <button class="custom-cart-btn w-100">ADD TO CART</button>
                                <div class="d_border"></div>
                            </div>
                           
                        </div>
                    </div>
                </div>
            `).join('');
        }

        document.addEventListener('DOMContentLoaded', function () {
            renderSwiperCards();
            new Swiper('.mySwiper', {
                slidesPerView: 3,
                spaceBetween: 24,
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                breakpoints: {
                    0: { slidesPerView: 1 },
                    576: { slidesPerView: 2 },
                    768: { slidesPerView: 3 },
                    1024: { slidesPerView: 3 },
                    1200: { slidesPerView: 4 },
                    1400: { slidesPerView: 4 },
                    1600: { slidesPerView: 5 },
                }
            });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const promoCheckbox = document.querySelector(".promo-code");

            promoCheckbox.addEventListener("click", function () {
                promoCheckbox.classList.toggle("active");
            });
        });
    </script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const itemId = localStorage.getItem('item_id');
            if (!itemId) {
                alert('No product selected!');
                window.location.href = 'allProduct.html'; // fallback
                return;
            }
            try {
                const res = await fetch(`http://localhost:4000/products/${itemId}`);
                if (!res.ok) throw new Error('Product not found');
                const product = await res.json();

                // Fill product details
                document.querySelector('.x_product-title').textContent = product.title;
                document.querySelector('.x_product-price').textContent = `£${product.price}`;
                document.querySelector('.x_main-img').src = product.image;
                // If you want to update thumbnails, do it here as well

                // Fill description tab
                document.getElementById('desc').textContent = product.description;

                // Optionally fill other fields (category, tags, etc.)
                // document.querySelector('.x_product-meta').innerHTML = ...;

            } catch (e) {
                alert('Error loading product');
                window.location.href = 'allProduct.html';
            }
        });
    </script>
</body>

</html>